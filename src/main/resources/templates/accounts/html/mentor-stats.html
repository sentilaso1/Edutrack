<!DOCTYPE html>
<html lang="vi">
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Thu Nh·∫≠p - Mentor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <style>

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 25px;
            margin-bottom: 40px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(255, 107, 157, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: #ff6b35;
        }

        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 60px rgba(255, 107, 157, 0.3);
        }

        .stat-card h3 {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1.2px;
            font-weight: 600;
        }

        .stat-card .value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ff5719;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(255, 107, 157, 0.1);
        }

        .stat-card .change {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 5px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .positive {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
        }

        .negative {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(255, 107, 53, 0.13);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }

        .chart-container:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 50px rgba(255, 107, 53, 0.13);
        }

        .chart-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }

        .chart-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 3px;
            background: linear-gradient(90deg, #ff7c4c, #ffbea4);
            border-radius: 2px;
        }

        .mentor-icon {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
        }

        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            border-left: 4px solid #ff7c4c;
        }

        .metric-card h4 {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .metric-card .metric-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #ff7c4c;
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2.2rem;
            }

            .stat-card .value {
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            color: #ff6b9d;
            font-size: 1.2rem;
        }

        .chart-loading {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 0.5;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.5;
            }
        }
    </style>
    <link rel="stylesheet" th:href="@{/assets/css/mentor_dashboard.css}">
    <link rel="stylesheet" th:href="@{/assets/css/courselist.css}"/>
</head>

<body>
<th:block th:insert="~{fragments/header :: header}"></th:block>
<div class="body" style="background-image: url('/assets/images/course-bg.png'); background-size: cover; background-position: center;">
    <th:block th:insert="~{fragments/mentor-aside :: aside}"></th:block>
    <div class="main">
        <div >
            <h2>Dashboard Income - Mentor</h2>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="mentor-icon">üí∞</span>
                <h3>Total income</h3>
                <div class="value" id="total-income" th:text="${#numbers.formatInteger(incomeStats.totalIncome, 0, 'POINT')} + '‚Ç´'">
                    0‚Ç´
                </div>
                <div class="change" th:text="${#numbers.formatDecimal(incomeStats.percentChange, 1, 1)} + '% compared to the previous month'">
                    0%
                </div>
            </div>
            <div class="stat-card">
                <span class="mentor-icon">üë•</span>
                <h3>Students taught</h3>
                <div class="value" id="total-students">127</div>
                <div class="change positive">+8 new student</div>
            </div>
            <div class="stat-card">
                <span class="mentor-icon">üìö</span>
                <h3>Completed course</h3>
                <div class="value" id="completed-courses">23</div>
                <div class="change positive">+3 course</div>
            </div>
            <div class="stat-card">
                <span class="mentor-icon">‚≠ê</span>
                <h3>Average review</h3>
                <div class="value" id="average-rating">4.8‚≠ê</div>
                <div class="change positive">+0.2 point</div>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">üìà Income over time</div>
                <canvas id="incomeChart"></canvas>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-container">
                <div class="chart-title">üë•Number of students by month</div>
                <canvas id="studentsChart"></canvas>
            </div>
            <div class="chart-container">
                <div class="chart-title">‚è±Ô∏è Weekly teaching time</div>
                <canvas id="hoursChart"></canvas>
            </div>
        </div>

        <div class="performance-metrics">
            <div class="metric-card">
                <h4>Completed rate</h4>
                <div class="metric-value">94.5%</div>
            </div>
            <div class="metric-card">
                <h4>Response time</h4>
                <div class="metric-value">2.3h</div>
            </div>
            <div class="metric-card">
                <h4>Registration rate</h4>
                <div class="metric-value">87.2%</div>
            </div>
            <div class="metric-card">
                <h4>Income per Slot</h4>
                <div class="metric-value" th:text="${#numbers.formatInteger(incomeStats.incomePerSlot, 0, 'POINT')} + '‚Ç´'">
                    0‚Ç´
                </div>
            </div>
        </div>
    </div>
</div>
<th:block th:insert="~{fragments/footer :: footer}"></th:block>


<script th:inline="javascript">
    const mentorData = {
        income: /*[[${incomeStats.incomeOverTime}]]*/[],
        labels: ['T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'CN'],
        students: [15, 18, 22, 20, 25, 23, 27, 30, 28, 32, 35, 38],
        studentLabels: ['T1', 'T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'T8', 'T9', 'T10', 'T11', 'T12'],
        hours: [25, 30, 28, 35, 32, 40, 38]
    };
</script>

<script>

    let charts = {};

    function initCharts() {
        // Income Chart
        const incomeCtx = document.getElementById('incomeChart').getContext('2d');
        charts.income = new Chart(incomeCtx, {
            type: 'line',
            data: {
                labels: mentorData.studentLabels,
                datasets: [{
                    label: 'Thu Nh·∫≠p (VNƒê)',
                    data: mentorData.income,
                    borderColor: '#ff6127',
                    backgroundColor: 'rgba(255, 107, 157, 0.1)',
                    fill: true,
                    tension: 0.4,
                    borderWidth: 4,
                    pointBackgroundColor: '#ff6127',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 3,
                    pointRadius: 8,
                    pointHoverRadius: 10
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {display: false},
                    tooltip: {
                        backgroundColor: 'rgba(255,97,39,0.41)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#ff6127',
                        borderWidth: 2,
                        cornerRadius: 10
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {
                            callback: function (value) {
                                return (value / 1000000).toFixed(1) + 'M‚Ç´';
                            },
                            color: '#666'
                        },
                        grid: {
                            color: 'rgba(255, 107, 157, 0.1)'
                        }
                    },
                    x: {
                        ticks: {color: '#666'},
                        grid: {display: false}
                    }
                }
            }
        });

        // Students Chart
        const studentsCtx = document.getElementById('studentsChart').getContext('2d');
        charts.students = new Chart(studentsCtx, {
            type: 'bar',
            data: {
                labels: mentorData.studentLabels,
                datasets: [{
                    label: 'S·ªë H·ªçc Vi√™n',
                    data: mentorData.students,
                    backgroundColor: 'rgba(255,97,39,0.71)',
                    borderColor: '#ff6127',
                    borderWidth: 2,
                    borderRadius: 8,
                    hoverBackgroundColor: '#ff6127'
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {display: false},
                    tooltip: {
                        backgroundColor: 'rgba(255,97,39,0.76)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#ff6127',
                        borderWidth: 2,
                        cornerRadius: 10
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        ticks: {color: '#666'},
                        grid: {color: 'rgba(255, 107, 157, 0.1)'}
                    },
                    x: {
                        ticks: {color: '#666'},
                        grid: {display: false}
                    }
                }
            }
        });

        // Hours Chart
        const hoursCtx = document.getElementById('hoursChart').getContext('2d');
        charts.hours = new Chart(hoursCtx, {
            type: 'radar',
            data: {
                labels: mentorData.labels,
                datasets: [{
                    label: 'Gi·ªù D·∫°y',
                    data: mentorData.hours,
                    borderColor: '#ff6127',
                    backgroundColor: 'rgba(255,97,39,0.22)',
                    pointBackgroundColor: '#ff6127',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 3,
                    pointRadius: 6,
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {display: false},
                    tooltip: {
                        backgroundColor: 'rgba(255,97,39,0.81)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#ff6127',
                        borderWidth: 2,
                        cornerRadius: 10
                    }
                },
                scales: {
                    r: {
                        beginAtZero: true,
                        ticks: {color: '#666'},
                        grid: {color: 'rgba(255,97,39,0.18)'},
                        pointLabels: {color: '#666'}
                    }
                }
            }
        });
    }

    function updatePeriod(period) {
        document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
        event.target.classList.add('active');

        // Simulate data update based on period
        console.log('Updating data for period:', period);

        // Add loading effect
        document.querySelectorAll('canvas').forEach(canvas => {
            canvas.parentElement.classList.add('chart-loading');
        });

        setTimeout(() => {
            document.querySelectorAll('.chart-container').forEach(container => {
                container.classList.remove('chart-loading');
            });
        }, 1000);
    }

    // Initialize charts on page load
    window.addEventListener('load', function () {
        setTimeout(initCharts, 500);
    });

    // Add entrance animations
    document.addEventListener('DOMContentLoaded', function () {
        const elements = document.querySelectorAll('.stat-card, .chart-container, .metric-card');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }, index * 100);
                }
            });
        });

        elements.forEach(element => {
            element.style.opacity = '0';
            element.style.transform = 'translateY(30px)';
            element.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
            observer.observe(element);
        });
    });

    // Real-time updates simulation
    setInterval(() => {
        const totalIncomeElement = document.getElementById('total-income');
        const currentValue = parseInt(totalIncomeElement.textContent.replace(/[^0-9]/g, ''));
        const newValue = currentValue + Math.floor(Math.random() * 100000);
        totalIncomeElement.textContent = newValue.toLocaleString('vi-VN') + '‚Ç´';
    }, 30000); // Update every 30 seconds
</script>
</body>

</html>